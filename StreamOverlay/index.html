<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="style.css" />
    <style>
        body, html {
            margin: 0;
            background-color:  transparent;
        }
        html {
            height: 100%;
            overflow: hidden;
            background-color: transparent;
            
        }
    </style>
    <script src="https://ngld.github.io/OverlayPlugin/assets/shared/common.min.js"></script>
    <script>

        var bossName = "";
        var maxHP = -1;
        var currentBest = 100;

        addOverlayListener("LogLine", (e) => ingestLine(e));

        startOverlayEvents();

        function ingestLine(data) 
        {
            if(data.line[0] != 37 && data.line[0] != 38)
                return;                  
            if(data.line[0] == 37) 
            {  
                //console.log(data.line);
                if(bossName == "" || data.line[3] != bossName)
                    return;
                var progress = document.getElementById('progressBar2');
                var value = (data.line[5] / maxHP * 100).toFixed(2).toString();
                if(value < currentBest)
                    currentBest = value;
                //console.log(value + "|" + data.line[5] + "|" + maxHP);
                updateBar(value, currentBest);
                //$('.progress-bar').css('width', value/10000+'%').attr('aria-valuenow', value);    
            }
            else
            {
                //console.log(data.line);
                if(data.line[6] < 1000000)
                    return;
                bossName = data.line[3].toString();        
                maxHP = data.line[6];
                document.getElementById('bar-Header').innerHTML = bossName;
            }     
        }

    </script>
</head>
<body>
    <div class="progress_container">
        <div class="progress">
            <div class="progress_item">
                <h3 class="progress_title" id="bar-Header">N/A</h3>
                <div class="progress_bar">
                    <div class="bar" data-value="100" data-text="100"></div>
                    <div class="bar-best" data-value="100" data-dext="100"></div>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
    </body>
</html>